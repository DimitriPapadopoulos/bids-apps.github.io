{{/*  Plots the apps by filtering them by dataset type and datatype */}}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<h3>
    <a href="{{ page.url }}#{{ include.ds_type }}-{{ include.datatype }}">
        <i class="fa fa-anchor"
           style="font-size:8px"
           id="{{ include.ds_type }}-{{ include.datatype }}"></i>
    </a>
    For BIDS {{ include.ds_type }} datasets: {{ include.datatype }} data
</h3>


<table>
    {% for app in include.apps %}

        {% assign display = false %}
        {% if app.datatype contains include.datatype and app.ds_type contains include.ds_type %}
            {% assign display = true %}
        {% endif %}

        {% if display %}
        {% else %}
            {% continue %}
        {% endif %}

        {% if app.branch %}
            {% assign branch = app.branch %}
        {% else %}
            {% assign branch = "master" %}
        {% endif %}

        <tr>
            <td>
                <a href="https://github.com/{{ app.gh }}">{{ app.gh }}</a>
            </td>
            <td>
                <img
                    src="https://img.shields.io/github/v/tag/{{ app.gh | downcase }}?label=version"
                />
            </td>
            <td>
                <a
                    href="https://github.com/{{ app.gh }}/issues?q=is%3Aopen+is%3Aissue+label%3Abug"
                >
                    <img src="https://img.shields.io/github/issues-raw/{{ app.gh }}" />
                </a>
            </td>
            <td>
                {% if app.ci == "travis" %}
                    <a href="https://app.travis-ci.com/{{ app.gh }}">
                        <img src="https://app.travis-ci.com/{{ app.gh }}.svg?branch={{ branch }}" />
                    </a>
                {% elsif app.ci == "gh" %}
                    <a href="https://github.com/{{ app.gh }}/actions/workflows/{{ app.workflow }}.yml/">
                        <img src="https://github.com/{{ app.gh }}/actions/workflows/{{ app.workflow }}.yml/badge.svg?branch={{ branch }}" />
                    </a>
                {% elsif app.ci == "none" %}
                    <img src="https://img.shields.io/badge/CI-unavailable-lightgrey" />
                {% else %}
                    <a href="https://circleci.com/gh/{{ app.gh }}/tree/{{ branch }}">
                    <img src="https://circleci.com/gh/{{ app.gh }}.svg?style=shield" />
                    </a>
                {% endif %}
            </td>
            <td>
                <a href="https://github.com/{{ app.gh }}/pulls">
                    <img
                    src="https://img.shields.io/github/issues-pr-raw/{{ app.gh }}/bug.svg"
                    />
                </a>
            </td>
            <td>
                <a href="https://hub.docker.com/r/{{ app.dh | downcase }}/">
                    <img
                    src="https://img.shields.io/docker/pulls/{{ app.dh | downcase }}.svg"
                    />
                </a>
            </td>
        </tr>
    {% endfor %}
</table>
